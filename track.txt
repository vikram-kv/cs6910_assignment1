# val_acc = 88.71
# function to create a parser that parses the commandline arguments
def gen_parser():
    parser = ap.ArgumentParser(description='Multi-Layer Feedfoward Neural Network with Various Optimizers')
    parser.add_argument('-wp','--wandb_project',dest='wdp', default='cs6910-assignment1', help='Project name used to track experiments in Weights & Biases dashboard')
    parser.add_argument('-we', '--wandb_entity',dest='wde', default='vikram-kv', help='Wandb Entity used to track experiments in the Weights & Biases dashboard')
    parser.add_argument('-d', '--dataset', dest='dataset', default='fashion_mnist', choices=['fashion_mnist', 'mnist'], help='Dataset to be used')
    parser.add_argument('-e', '--epochs', dest='epochs', default=10, type=int, help='Number of epochs to train neural network')
    parser.add_argument('-b', '--batch_size', dest='batch_size', default=128, type=int, help='Batch size used to train neural network')
    parser.add_argument('-l', '--loss', dest='loss', default='cross_entropy', choices=['mean_squared_error', 'cross_entropy'], help='Loss function to be used for training')
    parser.add_argument('-o', '--optimizer', dest='optimizer', default='adam', choices=['sgd', 'momentum', 'nag', 'rmsprop', 'adam', 'nadam'], help='Optimization method to use for training')
    parser.add_argument('-lr','--learning_rate', dest='learning_rate', default=0.5*1e-3, type=float, help='Learning rate used to optimize model parameters')
    parser.add_argument('-m', '--momentum', dest='momentum', default=0.9, type=float, help='Momentum used by momentum and nag optimizers')
    parser.add_argument('-beta', '--beta', dest='beta', default=0.95, type=float, help='Beta used by rmsprop optimizer')
    parser.add_argument('-beta1', '--beta1', dest='beta1', default=0.9, type=float, help='Beta1 used by adam and nadam optimizers.')
    parser.add_argument('-beta2', '--beta2', dest='beta2', default=0.999, type=float, help='Beta2 used by adam and nadam optimizers.')
    parser.add_argument('-eps', '--epsilon', dest='epsilon', default=1e-8, type=float, help='Epsilon used by optimizers')
    parser.add_argument('-w_d', '--weight_decay', dest='weight_decay', default=0.05, type=float, help='Weight decay used by optimizers')
    parser.add_argument('-w_i', '--weight_init', dest='weight_init', default='xavier', choices=['random', 'xavier', 'he'], help='Weight initialization method to be used')
    parser.add_argument('-nhl', '--num_layers', dest='num_layers', default=5, type=int, help='Number of hidden layers used in feedforward neural network')
    parser.add_argument('-sz', '--hidden_size', dest='hidden_size', default=128, type=int, help='Number of hidden neurons in a feedforward layer')
    parser.add_argument('-a', '--activation', dest='activation', default='leakyrelu', choices=['identity', 'sigmoid', 'tanh', 'relu', 'leakyrelu', 'elu'], help='Activation function to be used')
    parser.add_argument('-wlog', '--wlog_data', dest='logging', type=int, default=0, help='non-zero for wandb sweeping and logging')
    return parser


# 88.58 in 10 epochs
# function to create a parser that parses the commandline arguments
def gen_parser():
    parser = ap.ArgumentParser(description='Multi-Layer Feedfoward Neural Network with Various Optimizers')
    parser.add_argument('-wp','--wandb_project',dest='wdp', default='cs6910-assignment1', help='Project name used to track experiments in Weights & Biases dashboard')
    parser.add_argument('-we', '--wandb_entity',dest='wde', default='cs19b021', help='Wandb Entity used to track experiments in the Weights & Biases dashboard')
    parser.add_argument('-d', '--dataset', dest='dataset', default='fashion_mnist', choices=['fashion_mnist', 'mnist'], help='Dataset to be used')
    parser.add_argument('-e', '--epochs', dest='epochs', default=10, type=int, help='Number of epochs to train neural network')
    parser.add_argument('-b', '--batch_size', dest='batch_size', default=128, type=int, help='Batch size used to train neural network')
    parser.add_argument('-l', '--loss', dest='loss', default='cross_entropy', choices=['mean_squared_error', 'cross_entropy'], help='Loss function to be used for training')
    parser.add_argument('-o', '--optimizer', dest='optimizer', default='adam', choices=['sgd', 'momentum', 'nag', 'rmsprop', 'adam', 'nadam'], help='Optimization method to use for training')
    parser.add_argument('-lr','--learning_rate', dest='learning_rate', default=8*1e-4, type=float, help='Learning rate used to optimize model parameters')
    parser.add_argument('-m', '--momentum', dest='momentum', default=0.9, type=float, help='Momentum used by momentum and nag optimizers')
    parser.add_argument('-beta', '--beta', dest='beta', default=0.95, type=float, help='Beta used by rmsprop optimizer')
    parser.add_argument('-beta1', '--beta1', dest='beta1', default=0.9, type=float, help='Beta1 used by adam and nadam optimizers.')
    parser.add_argument('-beta2', '--beta2', dest='beta2', default=0.999, type=float, help='Beta2 used by adam and nadam optimizers.')
    parser.add_argument('-eps', '--epsilon', dest='epsilon', default=1e-8, type=float, help='Epsilon used by optimizers')
    parser.add_argument('-w_d', '--weight_decay', dest='weight_decay', default=0.1, type=float, help='Weight decay used by optimizers')
    parser.add_argument('-w_i', '--weight_init', dest='weight_init', default='xavier', choices=['random', 'xavier', 'he'], help='Weight initialization method to be used')
    parser.add_argument('-nhl', '--num_layers', dest='num_hlayers', default=5, type=int, help='Number of hidden layers used in feedforward neural network')
    parser.add_argument('-sz', '--hidden_size', dest='hidden_size', default=128, type=int, help='Number of hidden neurons in a feedforward layer')
    parser.add_argument('-a', '--activation', dest='activation_function', default='leakyrelu', choices=['identity', 'sigmoid', 'tanh', 'relu', 'leakyrelu', 'elu'], help='Activation function to be used')
    parser.add_argument('-uw', '--log_wandb', dest='log_wandb', type=int, default=0, help='non-zero for wandb logging')
    parser.add_argument('-rn', '--run_name', dest='run_name', default=None, help='non-zero for wandb sweeping and logging')
    return parser